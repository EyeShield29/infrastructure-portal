<!DOCTYPE html>
<html lang="en">
<head>
<title>新增用户</title>
<meta name="decorator" content="form" />
</head>

<body>
	<div class="breadcrumbs" id="breadcrumbs">
		<script type="text/javascript">
							try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
						</script>

		<ul class="breadcrumb">
			<li><i class="ace-icon fa fa-home home-icon"></i> <a href="${ctx}/home">主页</a>
			</li>

			<li><a href="#">项目管理</a></li>
			<li><a href="#">项目列表</a></li>
			<li class="active">项目详情</li>
		</ul>
		<!-- /.breadcrumb -->

		<!-- /section:basics/content.searchbox -->
	</div>

	<!-- /section:basics/content.breadcrumbs -->
	<div class="page-content">

		<!-- /section:settings.box -->
		<div class="page-header">
			<h1>
				项目管理 <small> <i class="ace-icon fa fa-angle-double-right"></i>
					项目列表
				</small><small> <i class="ace-icon fa fa-angle-double-right"></i>
					项目详情
				</small>
			</h1>
		</div>
		<!-- /.page-header -->

		<div class="row">
			<div class="col-xs-12">
				&nbsp;&nbsp;&nbsp;
				
				<button class="btn btn-sm btn-purple" data-toggle="modal"
					data-target="#modify_project-modal" href="javascript:void(0)"
					onclick="modifyProjectInfo('${projectInfo.id}','${projectInfo.projectNum}','${projectInfo.projectName}','${projectInfo.typeName}','${projectInfo.leaderId}','${projectInfo.company}','${projectInfo.description}')">
					<i class="icon-edit bigger-120"></i>修改基本信息
				</button>&nbsp;&nbsp;&nbsp;
				<!-- <button class="btn btn-sm btn-purple" data-toggle="modal"
					data-target="#modify_project_process-modal" href="javascript:void(0)"
					onclick="modifyProcessProcess()">
					<i class="icon-edit bigger-120"></i>修改流程信息
				</button> -->

			</div>
		</div>

		<div class="row">
			<div class="col-xs-12">
				<h3 class="lighter block green">项目基本信息</h3>
				<form class="form-horizontal" role="form">
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目编号 :</label>
						
						<div class="col-sm-9">
							<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.projectNum}</label>
						</div>
					</div>
					
					<div class="space-2"></div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目名称 :</label>
	
						<div class="col-sm-9">
						<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.projectName} </label>
						</div>
					</div>
					
					<div class="space-2"></div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目类型 :</label>
	
						<div class="col-sm-9">
						<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.typeName} </label>
						</div>
					</div>
					
					<div class="space-2"></div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目负责人 :</label>
	
						<div class="col-sm-9">
						<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.leaderName} </label>
						</div>
					</div>
					
					<div class="space-2"></div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目负责公司 :</label>
	
						<div class="col-sm-9">
						<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.company} </label>
						</div>
					</div>
					
					<div class="space-2"></div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目当前状态 :</label>
	
						<div class="col-sm-9">
						<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.status} </label>
						</div>
					</div>
					
					<div class="space-2"></div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目录入人员 :</label>
	
						<div class="col-sm-9">
						<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.entryStaffAccount} </label>
						</div>
					</div>
					
					<div class="space-2"></div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目录入时间 :</label>
	
						<div class="col-sm-9">
						<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.createTime?string('yyyy-MM-dd HH:mm:ss')} </label>
						</div>
					</div>
					
					<div class="space-2"></div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目简述 :</label>
	
						<div class="col-sm-9" style="word-wrap: break-word;word-break: normal;">
							<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.description}</label>
						</div>
					</div>
					
					<div class="form-group">
						<label class="col-sm-3 control-label no-padding-right"> 项目起止时间 :</label>
	
						<div class="col-sm-9" style="word-wrap: break-word;word-break: normal;">
							<label class="col-sm-3 control-label no-padding-right" style="text-align:left"> ${projectInfo.projectStartDate?string("yyyy-MM-dd")}</br>到${projectInfo.projectEndDate?string("yyyy-MM-dd")}</label>
						</div>
					</div>
				</form>
			</div>
			
			
		</div>
		
		<div class="hr hr-dotted"></div>


		<div class="row">
			<div class="col-xs-12">
				<!-- PAGE CONTENT BEGINS -->
				<h3 class="lighter block green">项目流程信息</h3>
				<div class="col-xs-12">
				&nbsp;&nbsp;&nbsp;
				
				<!-- <button class="btn btn-sm btn-purple" data-toggle="modal"
					data-target="#finish_process-modal" href="javascript:void(0)"
					onclick="finishProcess('${projectInfo.id}','${processId}','${projectInfo.status}')">
					<i class="icon-edit bigger-120"></i>进入下一流程
				</button> -->
				<!-- <button class="btn btn-sm btn-purple" data-toggle="modal"
					data-target="#modify_project_process-modal" href="javascript:void(0)"
					onclick="modifyProcessProcess()">
					<i class="icon-edit bigger-120"></i>修改流程信息
				</button> -->

			</div>
				<div id="timeline-2">
					<div class="row">
						<div class="col-xs-12 col-sm-10 col-sm-offset-1">
							<!-- #section:pages/timeline.style2 -->
							<div class="timeline-container timeline-style2">
								<span class="timeline-label"> <b>1.立项</b>
								</span>

								<div class="timeline-items">
									<#list period1 as process1>
										<div class="timeline-item clearfix">
											<div class="timeline-info">
												<span class="timeline-date">${process1.processName}</span> <i class="timeline-indicator btn btn-info no-hover"></i>
											</div>
	
											<div class="widget-box transparent">
												<div class="widget-body">
													<div class="widget-main no-padding"><#if process1.status=1>已完成，流程备注：${process1.remark}<#elseif process1.status=0>未完成，说明：${process1.description}</#if></div>
												</div>
											</div>
										</div>
									</#list>
								</div>
								<!-- /.timeline-items -->
							</div>
							<!-- /.timeline-container -->

							<!-- #section:pages/timeline.style2 -->
							<div class="timeline-container timeline-style2">
								<span class="timeline-label"> <b>2.设计</b>
								</span>

								<div class="timeline-items">
									<#list period2 as process2>
										<div class="timeline-item clearfix">
											<div class="timeline-info">
												<span class="timeline-date">${process2.processName}</span> <i class="timeline-indicator btn btn-info no-hover"></i>
											</div>
	
											<div class="widget-box transparent">
												<div class="widget-body">
													<div class="widget-main no-padding"><#if process2.status=1>已完成，流程备注：${process2.remark}<#elseif process2.status=0>未完成，说明：${process2.description}</#if></div>
												</div>
											</div>
										</div>
									</#list>
								</div>
								<!-- /.timeline-items -->
							</div>
							<!-- /.timeline-container -->
							
							
							<!-- #section:pages/timeline.style2 -->
							<div class="timeline-container timeline-style2">
								<span class="timeline-label"> <b>3.预算清单</b>
								</span>

								<div class="timeline-items">
									<#list period3 as process3>
										<div class="timeline-item clearfix">
											<div class="timeline-info">
												<span class="timeline-date">${process3.processName}</span> <i class="timeline-indicator btn btn-info no-hover"></i>
											</div>
	
											<div class="widget-box transparent">
												<div class="widget-body">
													<div class="widget-main no-padding"><#if process3.status=1>已完成，流程备注：${process3.remark}<#elseif process3.status=0>未完成，说明：${process3.description}</#if></div>
												</div>
											</div>
										</div>
									</#list>
								</div>
								<!-- /.timeline-items -->
							</div>
							<!-- /.timeline-container -->
							
							<!-- #section:pages/timeline.style2 -->
							<div class="timeline-container timeline-style2">
								<span class="timeline-label"> <b>4.招标</b>
								</span>

								<div class="timeline-items">
									<#list period4 as process4>
										<div class="timeline-item clearfix">
											<div class="timeline-info">
												<span class="timeline-date">${process4.processName}</span> <i class="timeline-indicator btn btn-info no-hover"></i>
											</div>
	
											<div class="widget-box transparent">
												<div class="widget-body">
													<div class="widget-main no-padding"><#if process1.status=4>已完成，流程备注：${process4.remark}<#elseif process4.status=0>未完成，说明：${process4.description}</#if></div>
												</div>
											</div>
										</div>
									</#list>
								</div>
								<!-- /.timeline-items -->
							</div>
							<!-- /.timeline-container -->
							
							<!-- #section:pages/timeline.style2 -->
							<div class="timeline-container timeline-style2">
								<span class="timeline-label"> <b>5.施工监管</b>
								</span>

								<div class="timeline-items">
									<#list period5 as process5>
										<div class="timeline-item clearfix">
											<div class="timeline-info">
												<span class="timeline-date">${process5.processName}</span> <i class="timeline-indicator btn btn-info no-hover"></i>
											</div>
	
											<div class="widget-box transparent">
												<div class="widget-body">
													<div class="widget-main no-padding"><#if process5.status=1>已完成，流程备注：${process5.remark}<#elseif process5.status=0>未完成，说明：${process5.description}</#if></div>
												</div>
											</div>
										</div>
									</#list>
								</div>
								<!-- /.timeline-items -->
							</div>
							<!-- /.timeline-container -->
							
							<!-- #section:pages/timeline.style2 -->
							<div class="timeline-container timeline-style2">
								<span class="timeline-label"> <b>6.结算</b>
								</span>

								<div class="timeline-items">
									<#list period6 as process6>
										<div class="timeline-item clearfix">
											<div class="timeline-info">
												<span class="timeline-date">${process6.processName}</span> <i class="timeline-indicator btn btn-info no-hover"></i>
											</div>
	
											<div class="widget-box transparent">
												<div class="widget-body">
													<div class="widget-main no-padding"><#if process6.status=1>已完成，流程备注：${process6.remark}<#elseif process6.status=0>未完成，说明：${process6.description}</#if></div>
												</div>
											</div>
										</div>
									</#list>
								</div>
								<!-- /.timeline-items -->
							</div>
							<!-- /.timeline-container -->
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- /.row -->
	</div>
	<!-- /.page-content -->

	<div id="modify_project-modal" class="modal fade" tabindex="-1"
		function="dialog">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="blue bigger">修改项目基本信息</h4>
				</div>
				<div class="modal-body overflow-visible">
					<form class="form-inline" action="${ctx}/project/modifyProjectInfo"
						id="modify_project-form" method="post">
						<div class="row">
							<div class="col-xs-12">
								<!-- PAGE CONTENT BEGINS -->
								<div class="from-group">
									<div class="input-group">
										<input type="hidden" id="id" name="id"
											class="col-xs-10 col-sm-5" value="" /> 
										
										<label class="col-sm-3 control-label no-padding-right">项目编号:</label>
										<div class="col-sm-7">
											<input type="text" id="projectNum" name="projectNum"
												class="col-xs-10 col-sm-5" value="" readonly />
										</div>
										
										<label class="col-sm-3 control-label no-padding-right">项目名称:</label>
										<div class="col-sm-7">
											<input type="text" id="projectName" name="projectName"
												class="col-xs-10 col-sm-5" value="" required />
										</div>

										<label class="col-sm-3 control-label no-padding-right">项目类型:</label>
										<div class="col-sm-7">
											<select id="typeName" name="typeName" class="select2"
														data-placeholder="Click to Choose...">
												<#list typeList as type>
														<option value="${type.typeName}">${type.typeName}</option>
												</#list>
											</select>
										</div>

										<label class="col-sm-3 control-label no-padding-right">项目负责人:</label>
										<div class="col-sm-7">
											<select id="leaderId" name="leaderId" class="select2" data-placeholder="Click to Choose...">
												<#list userList as user>
													<option value="${user.id}">${user.account}(${user.userName})</option>
												</#list>
											</select>
										</div>
										
										<label class="col-sm-3 control-label no-padding-right">项目负责公司名称:</label>
										<div class="col-sm-7">
											<input type="text" id="company" name="company"
												class="col-xs-10 col-sm-5" value="" required />
										</div>
										
										<label class="col-sm-3 control-label no-padding-right">项目描述:</label>
										<div class="col-sm-7">
											<textarea class="input-xlarge" name="description" id="description" required></textarea>
										</div>

									</div>
								</div>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button class="btn btn-sm btn-info"
						onclick="$('#modify_project-form').submit();">
						<i class="icon-ok"></i> 提交
					</button>
					<button class="btn btn-sm" data-dismiss="modal">
						<i class="icon-remove"></i> 取消
					</button>
				</div>
			</div>
		</div>
	</div>
	
	<!-- <div id="modify_project_process-modal" class="modal fade" tabindex="-1"
		function="dialog">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="blue bigger">修改项目流程信息</h4>
				</div>
				<div class="modal-body overflow-visible">
					<form class="form-horizontal" id="process-form" method="post"
						action="${ctx}/project/addProjectProcess">

						<input type="hidden" id="projectID" name="projectID"
							class="col-xs-12 col-sm-5" />

						<div class="form-group">
							<label class="control-label col-xs-12 col-sm-3 no-padding-right">阶段一</label>

							<div class="col-xs-12 col-sm-9">
								<div>
									<label> <input name="period1" value="1" type="checkbox"
										class="ace" /> <span class="lbl"> Latest news and
											announcements</span>
									</label>
								</div>
							</div>
						</div>

						<div class="hr hr-dotted"></div>

						<div class="form-group">
							<label class="control-label col-xs-12 col-sm-3 no-padding-right">阶段二</label>

							<div class="col-xs-12 col-sm-9">
								<div>
									<label> <input name="period2" value="1" type="checkbox"
										class="ace" /> <span class="lbl"> Latest news and
											announcements</span>
									</label>
								</div>
							</div>
						</div>

						<div class="hr hr-dotted"></div>

						<div class="form-group">
							<label class="control-label col-xs-12 col-sm-3 no-padding-right">阶段三</label>

							<div class="col-xs-12 col-sm-9">
								<div>
									<label> <input name="period3" value="1" type="checkbox"
										class="ace" /> <span class="lbl"> Latest news and
											announcements</span>
									</label>
								</div>
							</div>
						</div>

						<div class="hr hr-dotted"></div>

						<div class="form-group">
							<label class="control-label col-xs-12 col-sm-3 no-padding-right">阶段四</label>

							<div class="col-xs-12 col-sm-9">
								<div>
									<label> <input name="period4" value="1" type="checkbox"
										class="ace" /> <span class="lbl"> Latest news and
											announcements</span>
									</label>
								</div>
							</div>
						</div>

						<div class="hr hr-dotted"></div>

						<div class="form-group">
							<label class="control-label col-xs-12 col-sm-3 no-padding-right">阶段五</label>

							<div class="col-xs-12 col-sm-9">
								<div>
									<label> <input name="period5" value="1" type="checkbox"
										class="ace" /> <span class="lbl"> Latest news and
											announcements</span>
									</label>
								</div>
							</div>
						</div>

						<div class="hr hr-dotted"></div>

						<div class="form-group">
							<label class="control-label col-xs-12 col-sm-3 no-padding-right">阶段六</label>

							<div class="col-xs-12 col-sm-9">
								<div>
									<label> <input name="period6" value="1" type="checkbox"
										class="ace" /> <span class="lbl"> Latest news and
											announcements</span>
									</label>
								</div>
							</div>
						</div>

						<div class="space-2"></div>
					</form>
				</div>
				<div class="modal-footer">
					<button class="btn btn-sm btn-info"
						onclick="$('#modify_project_process-form').submit();">
						<i class="icon-ok"></i> 提交
					</button>
					<button class="btn btn-sm" data-dismiss="modal">
						<i class="icon-remove"></i> 取消
					</button>
				</div>
			</div>
		</div>
	</div> -->
	
	<!-- <div id="finish_process-modal" class="modal fade" tabindex="-1"
		function="dialog">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="blue bigger">进入下一流程</h4>
				</div>
				<div class="modal-body overflow-visible">
					<form class="form-inline" action="${ctx}/project/finishProjectProcess"
						id="finish_process-form" method="post">
						<div class="row">
							<div class="col-xs-12">
								PAGE CONTENT BEGINS
								<div class="from-group">
									<div class="input-group">
										<input type="text" id="projectId" name="projectId" value=""
											class="col-xs-12 col-sm-5" /> 
										<input type="text" id="period" name="period" value=""
											class="col-xs-12 col-sm-5" /> 
										<input type="text" id="processId" name="processId" value=""
											class="col-xs-12 col-sm-5" /> 
										<label
											class="col-sm-3 control-label no-padding-right">当前流程工作备注:</label>
										<div class="col-sm-7">
											<textarea class="input-xlarge" name="remark"
												required></textarea>
										</div>
									</div>
								</div>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button class="btn btn-sm btn-info"
						onclick="$('#finish_process-form').submit();">
						<i class="icon-ok"></i> 提交
					</button>
					<button class="btn btn-sm" data-dismiss="modal">
						<i class="icon-remove"></i> 取消
					</button>
				</div>
			</div>
		</div>
	</div> -->

	<script type="text/javascript">
		$(function() {
			$("#modify_project-form").validate();
			$("#modify_project-form").bind('submit', function() {
				//校验表单
				if (!$(this).valid()) {
					return false;
				}
				ajaxSubmit(this, function(response) {
					response = $.parseJSON(response);
					if (response.status == 1) {
						alert("修改成功！");
						//window.open("${ctx}/portal_user/show_user_list");
						window.location.reload();
					} else {
						alert(response.errormsg);
					}
				});
				return false;
			});
			$("#modify_project_process-form").validate();
			$("#modify_project_process-form").bind('submit', function() {
				//校验表单
				if (!$(this).valid()) {
					return false;
				}
				ajaxSubmit(this, function(response) {
					response = $.parseJSON(response);
					if (response.status == 1) {
						alert("修改成功！");
						//window.open("${ctx}/portal_user/show_user_list");
						window.location.reload();
					} else {
						alert(response.errormsg);
					}
				});
				return false;
			});
			$("#finish_process-form").validate();
			$("#finish_process-form").bind('submit', function() {
				//校验表单
				if (!$(this).valid()) {
					return false;
				}
				ajaxSubmit(this, function(response) {
					response = $.parseJSON(response);
					if (response.status == 1) {
						alert("当前流程已完成！项目已进入下一流程！");
						//window.open("${ctx}/portal_user/show_user_list");
						window.location.reload();
					} else {
						alert(response.errormsg);
					}
				});
				return false;
			});
		});
		
		function modifyProjectInfo(id, projectNum, projectName, typeName, leaderId, company, description) {
			//alert(id+","+period+","+periodNmae+","+processName+","+description);
			$("#id").val(id);
			$("#projectNum").val(projectNum);
			$("#projectName").val(projectName);
			$("#typeName").val(typeName);
			$("#leaderId").val(leaderId);
			$("#company").val(company);
			$("#description").val(description);
		}
		function finishProcess(projectId, processId, period) {
			//alert(id+","+period+","+periodNmae+","+processName+","+description);
			$("#projectId").val(projectId);
			$("#processId").val(processId);
			$("#period").val(period);
		}
	</script>
</body>
</html>
