<!DOCTYPE html><html lang="en"><head><meta name="decorator" content="default" /><title>App版本管理</title></head><body>	<div class="page-content">		<div class="page-header">			<h1>App版本管理</h1>		</div>		<!-- /.page-header -->		<div class="row">			<div class="col-xs-12">				<!-- PAGE CONTENT BEGINS -->				<div class="row">					<div class="col-xs-12">						<button class="btn btn-sm btn-purple" data-toggle="modal"							data-target="#add_app_version-modal">							<i class="icon-edit bigger-120"></i>发布新版本						</button>						<div class="table-responsive" style="margin-top: 5px">							<table id="sample-table-1"								class="table table-striped table-bordered table-hover">								<thead>									<tr>										<!-- <th class="center"><label> <input type="checkbox"												class="ace" /> <span class="lbl"></span>										</label></th> -->										<th>app类型</th>										<th>系统类型</th>										<th>版本code</th>										<th>版本名称</th>										<th>创建时间</th>										<th></th>									</tr>								</thead>								<tbody>									<#list appVersionList as appVersion>									<tr>										<!-- <td class="center"><label> <input type="checkbox"												class="ace" /> <span class="lbl"></span>										</label></td> -->										<td><#if appVersion.appType==1>导购端<#elseif											appVersion.appType==2>用户端</#if></td>										<td><#if appVersion.sysType==1>ios<#elseif											appVersion.sysType==2>android</#if></td>										<td>${appVersion.versionCode}</td>										<td>${appVersion.versionName}</td>										<td>${appVersion.createTime}</td>										<td>											<div												class="visible-md visible-lg hidden-sm hidden-xs btn-group">												<button class="btn btn-sm btn-purple" data-rel="tooltip"													onclick="app_version.editAppVersion('${appVersion.id}')">													<span> <i class="icon-edit bigger-120"></i>编辑													</span>												</button>												<button class="btn btn-sm btn-danger"													onclick="app_version.deleteAppVersion('${appVersion.id}')"													data-rel="tooltip">													<span> <i class="icon-trash bigger-120"></i>删除													</span>												</button>											</div>										</td>									</tr>									</#list>								</tbody>							</table>						</div>						<!-- /.table-responsive -->					</div>					<!-- /span -->				</div>				<!-- /row -->				<!-- PAGE CONTENT ENDS -->			</div>			<!-- /.col -->		</div>		<!-- /.row -->	</div>	<!-- /.page-content -->	<a href="#" id="btn-scroll-up"		class="btn-scroll-up btn btn-sm btn-inverse"> <i		class="icon-double-angle-up icon-only bigger-110"></i>	</a>	<div id="add_app_version-modal" class="modal fade" tabindex="-1"		role="dialog">		<div class="modal-dialog modal-lg">			<div class="modal-content">				<div class="modal-header">					<button type="button" class="close" data-dismiss="modal">&times;</button>					<h4 class="blue bigger">新增App版本</h4>				</div>				<div class="modal-body overflow-visible">					<form id="add_app_version-form" class="form-horizontal" role="form"						action="${ctx}/app_version/ajax/add" method="post">						<div class="form-group">							<label class="col-sm-3 control-label no-padding-right">								app类型</label>							<div class="col-sm-7">								<select name="appType" class="col-sm-10"									id="add_app_version-appType">									<option value="0">请选择app类型</option>									<option value="1">导购端app</option>									<option value="2">用户端app</option>								</select>							</div>						</div>						<div class="space-4"></div>												<div class="form-group">							<label class="col-sm-3 control-label no-padding-right">								系统类型</label>							<div class="col-sm-7">								<select name="sysType" class="col-sm-10"									id="add_app_version-sysType">									<option value="0">请选择系统类型</option>									<option value="1">ios</option>									<option value="2">android</option>								</select>							</div>						</div>						<div class="space-4"></div>						<div class="form-group" style="display: none"							id="add_app_version-apkUpload">							<label class="col-sm-3 control-label no-padding-right">上传apk包</label>							<div class="col-sm-7">								<input class="input-file uniform_on"									id="add_app_version-apkfile" type="file"> <span									id="add_app_version-apkUrlView"></span>							</div>						</div>						<input type="hidden" id="add_app_version-apkUrl" name="apkUrl">						<div class="form-group">							<label class="col-sm-3 control-label no-padding-right"								for="versionName"> 版本名称 </label>							<div class="col-sm-7">								<input type="text" name="versionName" class="col-xs-10 col-sm-5"									required />							</div>						</div>						<div class="space-4"></div>						<div class="form-group">							<label class="col-sm-3 control-label no-padding-right"								for="versionCode"> 版本code </label>							<div class="col-sm-7">								<input type="number" name="versionCode"									class="col-xs-10 col-sm-5" required number="true" min="1" />							</div>						</div>						<div class="space-4"></div>						<div class="form-group">							<label class="col-sm-3 control-label no-padding-right">更新内容</label>							<div class="col-sm-7">								<textarea class="updateLog" name="updateLog" rows="2" required></textarea>							</div>						</div>					</form>				</div>				<div class="modal-footer">					<button class="btn btn-sm btn-info"						onclick="$('#add_app_version-form').submit();">						<i class="icon-ok"></i> 提交					</button>					<button class="btn btn-sm" data-dismiss="modal">						<i class="icon-remove"></i> 取消					</button>				</div>			</div>		</div>	</div>	<div id="edit_app_version-modal" class="modal fade" tabindex="-1"		role="dialog">		<div class="modal-dialog modal-lg">			<div class="modal-content">				<div class="modal-header">					<button type="button" class="close" data-dismiss="modal">&times;</button>					<h4 class="blue bigger">编辑App版本</h4>				</div>				<div class="modal-body overflow-visible">					<form id="edit_app_version-form" class="form-horizontal"						role="form" action="${ctx}/app_version/ajax/edit" method="post"></form>				</div>				<div class="modal-footer">					<button class="btn btn-sm btn-info"						onclick="$('#edit_app_version-form').submit();">						<i class="icon-ok"></i> 保存					</button>					<button class="btn btn-sm" data-dismiss="modal">						<i class="icon-remove"></i> 取消					</button>				</div>			</div>		</div>	</div>	<!-- inline scripts related to this page -->	<script charset="utf-8"		src="${ctx}/static/kindeditor/kindeditor-min.js"></script>	<script charset="utf-8" src="${ctx}/static/kindeditor/zh_CN.js"></script>	<script type="text/javascript">		$(function() {			app_version.init();			$.messager.model = {				ok : {					text : "确定",					classed : 'btn-info'				},				cancel : {					text : "取消",					classed : 'btn-error'				}			};		});		var app_version = {			add_app_version_updateLogEditor : '',			edit_app_version_updateLogEditor : '',			init : function() {				$("#add_app_version-sysType").bind('change', function() {					if ($(this).val() == 2) {						$('#add_app_version-apkUpload').show();					} else {						$('#add_app_version-apkUpload').hide();					}				});				$('#add_app_version-apkfile').uploadify(						{							'swf' : '${ctx}/static/swf/uploadify.swf',							'uploader' : '${ctx}/common/fileupload',							'buttonText' : '选择要上传的apk',							'method' : 'post',							'fileTypeExts' : '*.apk',							'fileObjName' : 'file',							'multi' : false,							'onUploadSuccess' : function(file, data, response) {								data = $.parseJSON(data);								if (data.status == 1) {									$('#add_app_version-apkUrlView').text(											data.data.fileuri);									$('#add_app_version-apkUrl').val(											data.data.fileuri);								} else {									alert(data.errormsg);								}							},						});				KindEditor						.ready(function(K) {							add_app_version_updateLogEditor = KindEditor									.create(											'#add_app_version-form .updateLog',											{												width : '345px',												minWidth : 345,												height : '400px',												resizeType : 0,												filterMode : false,												allowFlashUpload : false,												allowMediaUpload : false,												allowFileUpload : false,												allowPreviewEmoticons : false,												imageTabIndex : 1,												allowImageRemote : true,												formatUploadUrl : false,												uploadJson : '${ctx}/common/ajax/editor_image_upload',												items : [ 'source', '|',														'undo', 'redo', '|',														'wordpaste',														'quickformat',														'clearhtml', '|',														'justifyleft',														'justifycenter',														'justifyfull',														'insertorderedlist',														'insertunorderedlist',														'indent', 'outdent',														'|', 'fontname',														'fontsize', '|',														'forecolor',														'hilitecolor', 'bold',														'removeformat', '|',														'table', 'hr', 'image',														'link' ]											});						});				$("#add_app_version-form").validate();				$("#add_app_version-form").bind(						'submit',						function() {							//校验表单							if (!$(this).valid()) {								return false;							}							//处理html编辑器							$('#add_app_version-form .updateLog').text(									add_app_version_updateLogEditor.html());							ajaxSubmit(this, function(response) {								response = $.parseJSON(response);								if (response.status == 1) {									window.location.reload();								} else {									alert(response.errormsg);								}							});							return false;						});			},			deleteAppVersion : function(id) {				$.messager.confirm("删除App版本", "确定要删除该App版本吗!", function() {					window.open("${ctx}/app_version/delete?id=" + id, "_self");				});			},			editAppVersion : function(id) {				$('#edit_app_version-form')						.load(								"${ctx}/app_version/edit?id=" + id,								function() {									$("#edit_app_version-sysType")											.bind(													'change',													function() {														if ($(this).val() == 2) {															$(																	'#edit_app_version-apkUpload')																	.show();														} else {															$(																	'#edit_app_version-apkUpload')																	.hide();														}													});									$('#edit_app_version-apkfile')											.uploadify(													{														'swf' : '${ctx}/static/swf/uploadify.swf',														'uploader' : '${ctx}/common/fileupload',														'buttonText' : '选择要上传的apk',														'method' : 'post',														'fileTypeExts' : '*.apk',														'fileObjName' : 'file',														'multi' : false,														'onUploadSuccess' : function(																file, data,																response) {															data = $																	.parseJSON(data);															if (data.status == 1) {																$(																		'#edit_app_version-apkUrlView')																		.text(																				data.data.fileuri);																$(																		'#edit_app_version-apkUrl')																		.val(																				data.data.fileuri);															} else {																alert(data.errormsg);															}														},													});									edit_app_version_updateLogEditor = KindEditor											.create(													'#edit_app_version-form .updateLog',													{														width : '345px',														minWidth : 345,														height : '400px',														resizeType : 0,														filterMode : false,														allowFlashUpload : false,														allowMediaUpload : false,														allowFileUpload : false,														allowPreviewEmoticons : false,														imageTabIndex : 1,														allowImageRemote : true,														formatUploadUrl : false,														uploadJson : '${ctx}/common/ajax/editor_image_upload',														items : [																'source',																'|',																'undo',																'redo',																'|',																'wordpaste',																'quickformat',																'clearhtml',																'|',																'justifyleft',																'justifycenter',																'justifyfull',																'insertorderedlist',																'insertunorderedlist',																'indent',																'outdent', '|',																'fontname',																'fontsize',																'|',																'forecolor',																'hilitecolor',																'bold',																'removeformat',																'|', 'table',																'hr', 'image',																'link' ]													});									$("#edit_app_version-form").validate();									$("#edit_app_version-form")											.bind(													'submit',													function() {														//校验表单														if (!$(this).valid()) {															return false;														}														//处理html编辑器														$(																'#edit_app_version-form .updateLog')																.text(																		edit_app_version_updateLogEditor																				.html());														ajaxSubmit(																this,																function(																		response) {																	response = $																			.parseJSON(response);																	if (response.status == 1) {																		window.location																				.reload();																	} else {																		alert(response.errormsg);																	}																});														return false;													});									$('#edit_app_version-modal').modal('show');								});			}		}	</script></body></html>